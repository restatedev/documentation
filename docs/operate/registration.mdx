---
sidebar_position: 1
description: "Find out how to register new deployments with Restate."
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import Admonition from '@theme/Admonition';

# Registration

After deploying an endpoint, you need to register it with Restate.
That way Restate knows where it runs and can invoke it.

## Registering deployments

<Tabs groupId="interface" queryString>
<TabItem value="cli" label="CLI">

<CH.Section>

Register [a service endpoint URI](focus://1[30:44]) as follows:

```shell
restate deployments register localhost:9080
```

</CH.Section>

<details className="grey-details">
    <summary>Output</summary>

    ```shell
    ‚ùØ SERVICES THAT WILL BE ADDED:
    - CheckoutService
    Type: Service
    HANDLER  INPUT TYPE                                   OUTPUT TYPE
    handle   one of "empty or value of content-type */*"  value with content-type "application/json"

    - CartObject
    Type: VirtualObject ‚¨ÖÔ∏è üö∂üö∂üö∂
    HANDLER       INPUT TYPE                                   OUTPUT TYPE
    addTicket     one of "empty or value of content-type */*"  value with content-type "application/json"
    expireTicket  one of "empty or value of content-type */*"  value with content-type "application/json"
    checkout      one of "empty or value of content-type */*"  value with content-type "application/json"

    - TicketObject
    Type: VirtualObject ‚¨ÖÔ∏è üö∂üö∂üö∂
    HANDLER     INPUT TYPE                                   OUTPUT TYPE
    reserve     one of "empty or value of content-type */*"  value with content-type "application/json"
    markAsSold  one of "empty or value of content-type */*"  value with content-type "application/json"
    unreserve   one of "empty or value of content-type */*"  value with content-type "application/json"


    ‚úî Are you sure you want to apply those changes? ¬∑ yes
    ‚úÖ DEPLOYMENT:
    SERVICE          REV
    TicketObject     1
    CheckoutService  1
    CartObject       1
    ```
</details>

Or you can use the shorthand _`restate dp add`_.

</TabItem>
<TabItem value="curl" label="curl">

<CH.Section>
Register [a service endpoint URI](focus://1[72:99]) with [the Restate Admin API](focus://1[5:19]) ([docs](/references/admin-api#tag/deployment/operation/create_deployment)) as follows:

```bash
curl localhost:9070/deployments -H 'content-type: application/json' \
    -d '{"uri": "http://localhost:9080"}'
```

</CH.Section>

    <details className="grey-details">
        <summary>Output</summary>

        ```json
        {
            "id": "dp_11pXug0mWsff2NOoRBZbOcV",
            "services": [
                {
                    "name": "CartObject",
                    "handlers": [
                            {
                                "name": "checkout",
                                "ty": "Exclusive",
                                "input_description": "one of \"empty or value of content-type */*\"",
                                "output_description": "value with content-type \"application/json\""
                            },
                            {
                                "name": "expireTicket",
                                "ty": "Exclusive",
                                "input_description": "one of \"empty or value of content-type */*\"",
                                "output_description": "value with content-type \"application/json\""
                            },
                            {
                                "name": "addTicket",
                                "ty": "Exclusive",
                                "input_description": "one of \"empty or value of content-type */*\"",
                                "output_description": "value with content-type \"application/json\""
                            }
                    ],
                    "ty": "VirtualObject",
                    "deployment_id": "dp_11pXug0mWsff2NOoRBZbOcV",
                    "revision": 3,
                    "public": true,
                    "idempotency_retention": "1day"
                },
                {
                    "name": "CheckoutService",
                    "handlers": [
                        {
                            "name": "handle",
                            "ty": "Shared",
                            "input_description": "one of \"empty or value of content-type */*\"",
                            "output_description": "value with content-type \"application/json\""
                        }
                    ],
                    "ty": "Service",
                    "deployment_id": "dp_11pXug0mWsff2NOoRBZbOcV",
                    "revision": 3,
                    "public": true,
                    "idempotency_retention": "1day"
                }
            ]
        }
        ```
    </details>
</TabItem>
</Tabs>

To register a Lambda handler, replace `http://localhost:9080` by the ARN of the Lambda function, for example `arn:aws:lambda:my-region:123456789101:function:my-function:my-version`.

<Admonition type={"info"} title={"Running locally Restate with Docker"}>
When running Restate in a Docker, replace `localhost` with `host.docker.internal`.
</Admonition>
<Admonition type="info" title="Updating services">
A service can be registered only once. Subsequent registration requests to the same deployment will fail. For more details on how to update services, check the [versioning docs](/operate/versioning).
</Admonition>

When developing locally, you can forcefully overwrite an existing deployment:

<Tabs groupId="interface" queryString>
<TabItem value="cli" label="CLI">

```shell
restate deployments register --force localhost:9080
```

</TabItem>
<TabItem value="curl" label="curl">

```bash
curl localhost:9070/deployments -H 'content-type: application/json' \
    -d '{"uri": "localhost:9080", "force": true}'
```

</TabItem>
</Tabs>


This will forcefully overwrite the existing service deployment with the same URI, forcing the discovery process again. It will also remove services that were served by that deployment and are not available anymore.

<Admonition type="warning">
Forcing a deployment registration is a feature designed to simplify local Restate service development, and should never be used in a production Restate deployment, as it potentially breaks all the in-flight invocations to that deployment.
</Admonition>

## Private services
<CH.Section>
    When registering an endpoint, every service is by default reachable via HTTP requests.

    You can configure a service as `private`, such that you can't invoke it over HTTP, through the [Admin API](focus://1[15:28]) ([docs](/references/admin-api#tag/service/operation/modify_service)):

    ```shell
    curl -X PATCH localhost:9070/services/MyService \
        -H 'content-type: application/json' \
        -d '{"public": false}'
    ```

    You can revert it back to public with [`{"public": true}`](focus://3).

    <Admonition type="info">
        Private services can still be invoked by other handlers via the SDK.
    </Admonition>

</CH.Section>
