---
title: "Async tasks"
sidebar_position: 4
description: "Schedule async tasks and let Restate manage their execution."
hide_title: true
---

import FeatureWidget from "../../src/components/FeatureWidget"
import FeatureSpotlight from "../../src/components/FeatureSpotlight"
import TwoColumnText from "../../src/components/TwoColumnText";
import ExampleWidget from "../../src/components/ExampleWidget"
import FeatureList from "../../src/components/FeatureList"
import SpotlightCard from "../../src/components/SpotlightCard"
import {Scrollycoding} from "../../src/components/code/scrollycoding";
import Admonition from "@theme/Admonition";

<div className={"row"}>
    <div className={"col col--6 col-lg-6 col-md-12 "}>
        <h1 className={"padding-top--lg text--left"}>Async tasks</h1>
        <h1 className={"use-case-subtitle text--left"}>Flexible, durable scheduling across processes and time.</h1>
        <p className={"use-case-description padding-bottom--lg text--left"}>
            Restate lets you write resilient scheduling logic with the flexibility of code: delay execution, re-attach to ongoing tasks, fan out/in, etc.
            Restate runs your tasks to completion exactly once.
        </p>
    </div>
    <div className={"col col--6 col-lg-6 col-md-12"}>
        <img src={"/img/use_cases/use-case-async-tasks-light.svg"} alt={"Async tasks"} className={"use-case-img"}/>
    </div>
</div>

<hr/>
<p className={"padding-bottom--lg"}></p>

<FeatureList className={"padding-bottom--lg"} features={[
    {
        title: 'Durable timers',
        iconPath: '/img/use_cases/hour-glass.svg',
        description: "Register timers with Restate to make them durable. Restate makes sure that they get fired when they should, whether it's millis or months.",
    },
    {
        title: '(Delayed) task queue',
        iconPath: '/img/use_cases/queue.svg',
        description: "Schedule tasks asynchronously, by using Restate as message queue. Tasks execute with workflow-like semantics and durability. Restate handles retries and recovery of progress."
    },
    {
        title: 'Switch between async and sync',
        iconPath: '/img/use_cases/switch.svg',
        description: "Schedule an async task, by using Restate as queue. Let another process latch on to it later and wait for the result, or peek at the output to see if it has finished.",
    },
]}/>

<p className={"padding-bottom--lg"}></p>


## Scheduling async tasks with Restate
Schedule tasks for now or later with the Restate SDK.

<Scrollycoding>

    ### !!steps Restate as message queue

    Any function can be turned into an async task by using Restate as a message queue.
    Restate persists requests and makes sure they run to completion, with retries and recovery upon failures.

    ```ts !!tabs TypeScript https://github.com/restatedev/examples/blob/main/typescript/patterns-use-cases/src/queue/async_task_worker.ts
    CODE_LOAD::ts/src/use_cases/async_tasks/simple_async_task/async_task_service.ts?1
    ```

    ```java !!tabs Java https://github.com/restatedev/examples/blob/main/java/patterns-use-cases/src/main/java/my/example/queue/AsyncTaskWorker.java
    CODE_LOAD::java/src/main/java/usecases/asynctasks/simple/AsyncTaskService.java?1
    ```

    ```kotlin !!tabs Kotlin
    CODE_LOAD::kotlin/src/main/kotlin/usecases/asynctasks/simple/AsyncTaskService.kt?1
    ```

    ```go !!tabs Go https://github.com/restatedev/examples/blob/main/go/patterns-use-cases/src/queue/service/asynctaskworker.go
    CODE_LOAD::go/usecases/asynctasks/simpleasynctask/asynctaskworker.go?1
    ```

    ```python !!tabs Python https://github.com/restatedev/examples/blob/main/python/patterns-use-cases/src/queue/async_task_worker.py
    CODE_LOAD::python/src/use_cases/async_tasks/simple_async_task/async_task_service.py?1
    ```


</Scrollycoding>

<Scrollycoding>
    ### !!steps Schedule tasks over HTTP

    You can turn an HTTP invocation into an async event by adding  `/send` to the URL.
    You can schedule the task for later with the optional `?delay=10s` parameter.

    [Learn more](/concepts/invocations)

    ```ts !!tabs TypeScript https://github.com/restatedev/examples/blob/main/typescript/patterns-use-cases/src/queue/task_submitter.ts
    CODE_LOAD::ts/src/use_cases/async_tasks/simple_async_task/task_submitter.ts?1
    ```

    ```java !!tabs Java https://github.com/restatedev/examples/blob/main/java/patterns-use-cases/src/main/java/my/example/queue/TaskSubmitter.java
    CODE_LOAD::java/src/main/java/usecases/asynctasks/simple/TaskSubmitter.java?1
    ```

    ```kotlin !!tabs Kotlin
    CODE_LOAD::kotlin/src/main/kotlin/usecases/asynctasks/simple/TaskSubmitter.kt?1
    ```

    ```go !!tabs Go https://github.com/restatedev/examples/blob/main/go/patterns-use-cases/src/queue/client/tasksubmitter.go
    CODE_LOAD::go/usecases/asynctasks/simpleasynctask/client/tasksubmitter.go?1
    ```

    ```python !!tabs Python https://github.com/restatedev/examples/blob/main/python/patterns-use-cases/src/queue/task_submitter.py
    CODE_LOAD::python/src/use_cases/async_tasks/simple_async_task/task_submitter.py?1
    ```

    ### !!steps Deduplicate requests

    Use an idempotency key to ensure that the task is only scheduled once.
    For duplicate requests, Restate returns the previous response.

    ```ts !!tabs TypeScript https://github.com/restatedev/examples/blob/main/typescript/patterns-use-cases/src/queue/task_submitter.ts
    CODE_LOAD::ts/src/use_cases/async_tasks/simple_async_task/task_submitter.ts?2
    ```

    ```java !!tabs Java https://github.com/restatedev/examples/blob/main/java/patterns-use-cases/src/main/java/my/example/queue/TaskSubmitter.java
    CODE_LOAD::java/src/main/java/usecases/asynctasks/simple/TaskSubmitter.java?2
    ```

    ```kotlin !!tabs Kotlin
    CODE_LOAD::kotlin/src/main/kotlin/usecases/asynctasks/simple/TaskSubmitter.kt?2
    ```

    ```go !!tabs Go https://github.com/restatedev/examples/blob/main/go/patterns-use-cases/src/queue/client/tasksubmitter.go
    CODE_LOAD::go/usecases/asynctasks/simpleasynctask/client/tasksubmitter.go?2
    ```

    ```python !!tabs Python https://github.com/restatedev/examples/blob/main/python/patterns-use-cases/src/queue/task_submitter.py
    CODE_LOAD::python/src/use_cases/async_tasks/simple_async_task/task_submitter.py?2
    ```

    ### !!steps Latch on to the task

    Use the idempotency key to latch onto the task later and retrieve the result.
    You can also let another process latch on.

    [Learn more](http://localhost:3000/invoke/http#retrieve-result-of-invocations-and-workflows)

    ```ts !!tabs TypeScript https://github.com/restatedev/examples/blob/main/typescript/patterns-use-cases/src/queue/task_submitter.ts
    CODE_LOAD::ts/src/use_cases/async_tasks/simple_async_task/task_submitter.ts?3
    ```

    ```java !!tabs Java https://github.com/restatedev/examples/blob/main/java/patterns-use-cases/src/main/java/my/example/queue/TaskSubmitter.java
    CODE_LOAD::java/src/main/java/usecases/asynctasks/simple/TaskSubmitter.java?3
    ```

    ```kotlin !!tabs Kotlin
    CODE_LOAD::kotlin/src/main/kotlin/usecases/asynctasks/simple/TaskSubmitter.kt?3
    ```

    ```go !!tabs Go https://github.com/restatedev/examples/blob/main/go/patterns-use-cases/src/queue/client/tasksubmitter.go
    CODE_LOAD::go/usecases/asynctasks/simpleasynctask/client/tasksubmitter.go?3
    ```

    ```python !!tabs Python https://github.com/restatedev/examples/blob/main/python/patterns-use-cases/src/queue/task_submitter.py
    CODE_LOAD::python/src/use_cases/async_tasks/simple_async_task/task_submitter.py?3
    ```

</Scrollycoding>

<SpotlightCard>
    <TwoColumnText features={[
        {
            title: 'LOW-LATENCY',
            description: "Restateâ€™s event-driven foundation built in Rust lets you queue events. Restate pushes them to your functions at high speed.",
        },
        {
            title: 'DURABLE EXECUTION',
            description: "Restate makes sure all tasks run to completion. It keeps track of timers, handles retries and recovery upon failures, and ensures that tasks are executed exactly once.",
        },
    ]}/>
</SpotlightCard>

## Parallelizing work with Restate

<Scrollycoding>

    ### !!steps Fan out

    Write flexible scheduling logic via durable building blocks.
    Fan out tasks with Restate's resilient RPC calls.

    Restate makes sure all tasks run to completion, with retries and recovery upon failures.

    ```ts !!tabs TypeScript https://github.com/restatedev/examples/blob/main/typescript/patterns-use-cases/src/parallelizework/fan_out_worker.ts
    CODE_LOAD::ts/src/use_cases/async_tasks/fan_out_worker.ts?1
    ```

    ```java !!tabs Java https://github.com/restatedev/examples/blob/main/java/patterns-use-cases/src/main/java/my/example/parallelizework/FanOutWorker.java
    CODE_LOAD::java/src/main/java/usecases/asynctasks/FanOutWorker.java?1
    ```

    ```kotlin !!tabs Kotlin
    CODE_LOAD::kotlin/src/main/kotlin/usecases/asynctasks/FanOutWorker.kt?1
    ```

    ```go !!tabs Go https://github.com/restatedev/examples/blob/main/go/patterns-use-cases/src/parallelizework/fanoutworker.go
    CODE_LOAD::go/usecases/asynctasks/parallelizework/fanoutworker.go?1
    ```

    ```python !!tabs Python https://github.com/restatedev/examples/blob/main/python/patterns-use-cases/src/parallelizework/fan_out_worker.py
    CODE_LOAD::python/src/use_cases/async_tasks/fan_out_worker.py?1
    ```

    ### !!steps Fan in
    Invocations produce durable promises that can be awaited and combined.
    Durable promises recover from failures, re-connect to running subtasks.

    ```ts !!tabs TypeScript https://github.com/restatedev/examples/blob/main/typescript/patterns-use-cases/src/parallelizework/fan_out_worker.ts
    CODE_LOAD::ts/src/use_cases/async_tasks/fan_out_worker.ts?2
    ```

    ```java !!tabs Java https://github.com/restatedev/examples/blob/main/java/patterns-use-cases/src/main/java/my/example/parallelizework/FanOutWorker.java
    CODE_LOAD::java/src/main/java/usecases/asynctasks/FanOutWorker.java?2
    ```

    ```kotlin !!tabs Kotlin
    CODE_LOAD::kotlin/src/main/kotlin/usecases/asynctasks/FanOutWorker.kt?2
    ```

    ```go !!tabs Go https://github.com/restatedev/examples/blob/main/go/patterns-use-cases/src/parallelizework/fanoutworker.go
    CODE_LOAD::go/usecases/asynctasks/parallelizework/fanoutworker.go?2
    ```

    ```python !!tabs Python https://github.com/restatedev/examples/blob/main/python/patterns-use-cases/src/parallelizework/fan_out_worker.py
    CODE_LOAD::python/src/use_cases/async_tasks/fan_out_worker.py?2
    ```

    ### !!steps Server(less)
    Deploy this service or the subtasks on a platform like Kubernetes or AWS Lambda to
    automatically get parallel scale out.

    [Learn more](https://restate.dev/blog/we-replaced-400-lines-of-stepfunctions-asl-with-40-lines-of-typescript-by-making-lambdas-suspendable/)

    ```ts !!tabs TypeScript https://github.com/restatedev/examples/blob/main/typescript/patterns-use-cases/src/parallelizework/fan_out_worker.ts
    CODE_LOAD::ts/src/use_cases/async_tasks/fan_out_worker.ts?3
    ```

    ```java !!tabs Java https://github.com/restatedev/examples/blob/main/java/patterns-use-cases/src/main/java/my/example/parallelizework/FanOutWorker.java
    CODE_LOAD::java/src/main/java/usecases/asynctasks/FanOutWorker.java?3
    ```

    ```kotlin !!tabs Kotlin
    CODE_LOAD::kotlin/src/main/kotlin/usecases/asynctasks/FanOutWorker.kt?3
    ```

    ```go !!tabs Go https://github.com/restatedev/examples/blob/main/go/patterns-use-cases/src/parallelizework/fanoutworker.go
    CODE_LOAD::go/usecases/asynctasks/parallelizework/fanoutworker.go?3
    ```

    ```python !!tabs Python https://github.com/restatedev/examples/blob/main/python/patterns-use-cases/src/parallelizework/fan_out_worker.py
    CODE_LOAD::python/src/use_cases/async_tasks/fan_out_worker.py?3
    ```

</Scrollycoding>

<SpotlightCard>
    <FeatureSpotlight
        title={"Restate as sophisticated task queue"}
        description={<p>Restate is built as an event-driven foundation, and therefore supports task queues by design. <br/> Async tasks run like any other function in your infrastructure: on K8S, FaaS, or mix-and-match. <br/> No need to spin up extra infrastructure or message queues.</p>}
        imgPath={"/img/use_cases/workflows-white.svg"}
    />
</SpotlightCard>



## Durable webhook processing with Restate

<Scrollycoding>
    ### !!steps Restate handlers as durable event processors
    You can point your webhook endpoint to any Restate handler.

    Restate makes sure all events are persisted and run to completion.

    ```ts !!tabs TypeScript
    CODE_LOAD::ts/src/use_cases/async_tasks/reminders/payment_reminders.ts?1
    ```

    ### !!steps

    You can schedule follow-up tasks for webhook events, like reminders or escalations.


    ```ts !!tabs TypeScript
    CODE_LOAD::ts/src/use_cases/async_tasks/reminders/payment_reminders.ts?2
    ```

    ### !!steps Correlating events

    You can correlate or join async events by sending them to the same object.

    Restate ensures sequential processing of events for the same key.


    ```ts !!tabs TypeScript
    CODE_LOAD::ts/src/use_cases/async_tasks/reminders/payment_reminders.ts?3
    ```

</Scrollycoding>

## Switch between async and sync with Restate

Restate lets you easily convert synchronous tasks to asynchronous ones, and back.

<Scrollycoding>
    ### !!steps Submit synchronous workflow

    Submit a new workflow to upload a file.
    This is idempotent per workflow ID (here user id).

    Wait for the response for 30 seconds.

    ```ts !!tabs TypeScript https://github.com/restatedev/examples/blob/main/typescript/patterns-use-cases/src/syncasync/client.ts
    CODE_LOAD::ts/src/use_cases/async_tasks/sync_to_async/client.ts?1
    ```

    ```java !!tabs Java https://github.com/restatedev/examples/blob/main/java/patterns-use-cases/src/main/java/my/example/syncasync/UploadClient.java
    CODE_LOAD::java/src/main/java/usecases/asynctasks/synctoasync/MyClient.java?1
    ```

    ```kotlin !!tabs Kotlin
    CODE_LOAD::kotlin/src/main/kotlin/usecases/asynctasks/synctoasync/MyClient.kt?1
    ```

    ```go !!tabs Go https://github.com/restatedev/examples/blob/main/go/patterns-use-cases/src/syncasync/client/client.go
    CODE_LOAD::go/usecases/asynctasks/dataupload/client/client.go?1
    ```

    ```python !!tabs Python https://github.com/restatedev/examples/blob/main/python/patterns-use-cases/src/syncasync/client.py
    CODE_LOAD::python/src/use_cases/async_tasks/sync_to_async/client.py?1
    ```

    ### !!steps Switch from synchronous to asynchronous

    If the upload takes more than 30 seconds, then we want the workflow to notify us via email about the uploaded file URL.

    ```ts !!tabs TypeScript https://github.com/restatedev/examples/blob/main/typescript/patterns-use-cases/src/syncasync/client.ts
    CODE_LOAD::ts/src/use_cases/async_tasks/sync_to_async/client.ts?2
    ```

    ```java !!tabs Java https://github.com/restatedev/examples/blob/main/java/patterns-use-cases/src/main/java/my/example/syncasync/UploadClient.java
    CODE_LOAD::java/src/main/java/usecases/asynctasks/synctoasync/MyClient.java?2
    ```

    ```kotlin !!tabs Kotlin
    CODE_LOAD::kotlin/src/main/kotlin/usecases/asynctasks/synctoasync/MyClient.kt?2
    ```

    ```go !!tabs Go https://github.com/restatedev/examples/blob/main/go/patterns-use-cases/src/syncasync/client/client.go
    CODE_LOAD::go/usecases/asynctasks/dataupload/client/client.go?2
    ```

    ```python !!tabs Python https://github.com/restatedev/examples/blob/main/python/patterns-use-cases/src/syncasync/client.py
    CODE_LOAD::python/src/use_cases/async_tasks/sync_to_async/client.py?2
    ```

</Scrollycoding>
<Scrollycoding>
    ### !!steps Durable promises shared across handlers and retries

    When the file upload workflow is done, it resolves a promise with the file URL.

    If the email handler has been called in the mean time, then it would now get unblocked on the waiting on the URL promise, and would continue with sending the email.

    Restate persists these promises and makes sure they are recoverable.

    ```ts !!tabs TypeScript https://github.com/restatedev/examples/blob/main/typescript/patterns-use-cases/src/syncasync/data_upload_service.ts
    CODE_LOAD::ts/src/use_cases/async_tasks/sync_to_async/file_upload_workflow.ts?1
    ```

    ```java !!tabs Java https://github.com/restatedev/examples/blob/main/java/patterns-use-cases/src/main/java/my/example/syncasync/DataUploadService.java
    CODE_LOAD::java/src/main/java/usecases/asynctasks/synctoasync/FileUploadWorkflow.java?1
    ```

    ```kotlin !!tabs Kotlin
    CODE_LOAD::kotlin/src/main/kotlin/usecases/asynctasks/synctoasync/FileUploadWorkflow.kt?1
    ```

    ```go !!tabs Go https://github.com/restatedev/examples/blob/main/go/patterns-use-cases/src/syncasync/service/datauploadservice.go
    CODE_LOAD::go/usecases/asynctasks/dataupload/fileuploadworkflow.go?1
    ```

    ```py !!tabs Python https://github.com/restatedev/examples/blob/main/python/patterns-use-cases/src/syncasync/data_upload_service.py
    CODE_LOAD::python/src/use_cases/async_tasks/sync_to_async/file_upload_workflow.py?1
    ```

</Scrollycoding>


## What you can build with Async Tasks and Restate

<ExampleWidget itemsPerRow={3} features={[
    {
        title: "(Delayed) task queue",
        description: "A task queue that can handle both immediate and scheduled tasks. Restate makes sure task submissions are idempotent and that tasks run to completion exactly once. You can attach back to tasks to retrieve their result later.",
        links: [
            {url: "https://github.com/restatedev/examples/tree/main/java/patterns-use-cases/README.md#delayed-message-queue", icon: "/img/java.svg"},
            {url: "https://github.com/restatedev/examples/blob/main/typescript/patterns-use-cases/README.md#delayed-message-queue", icon: "/img/typescript.svg"},
            {url: "https://github.com/restatedev/examples/tree/main/python/patterns-use-cases/README.md#delayed-message-queue", icon: "/img/python.svg"},
            {url: "https://github.com/restatedev/examples/blob/main/go/patterns-use-cases/README.md#delayed-message-queue", icon: "/img/go.svg"}
        ]
    },
    {
        title: "Durable webhook event processing",
        description: "A Restate handler can be the endpoint for a webhook. Restate makes sure the events are persisted and retried until they run till completion.",
        links: [
            {url: "/guides/durable-webhooks", icon: "/img/arrow-right.svg"},
        ]
    },
    {
        title: "Complex task scheduling",
        description: "An invoice payment tracker which correlates payment success events and failure events. Until a success event is received, each failure event generates up to 3 daily reminders and then escalates to support.",
        links: [
            {url: "https://github.com/restatedev/examples/blob/main/typescript/patterns-use-cases/README.md#scheduling-tasks", icon: "/img/typescript.svg"},
            {url: "https://github.com/restatedev/examples/blob/main/go/patterns-use-cases/README.md#scheduling-tasks", icon: "/img/go.svg"},
        ]
    },
    {
        title: "Payments: Combining sync & async responses",
        description: "Issue an idempotent payment to Stripe and process the response. The payment provider either responds immediately or notifies us later via a webhook.",
        links: [
            {url: "https://github.com/restatedev/examples/tree/main/java/patterns-use-cases/README.md#payment-signals", icon: "/img/java.svg"},
            {url: "https://github.com/restatedev/examples/tree/main/typescript/patterns-use-cases/README.md#payment-signals", icon: "/img/typescript.svg"},
            {url: "https://github.com/restatedev/examples/tree/main/python/patterns-use-cases/README.md#payment-signals", icon: "/img/python.svg"}
        ]
    },
    {
        title: "Building Durable-Promises-as-a-Service with Restate",
        description: "Using Restate to build Promises/Futures as a service, that can be exposed to external clients and are durable across processes and failures..",
        links: [{url: "https://github.com/restatedev/examples/tree/main/typescript/patterns-use-cases/README.md#durable-promises-as-a-service", icon: "/img/typescript.svg"}]
    },
    {
        title: 'Wondering about a specific use case?',
        description: "Letâ€™s brainstorm together on Discord or Slack.",
        links: [
            {url: "https://discord.gg/skW3AZ6uGd", icon: "/img/discord-icon.svg"},
            {url: "https://join.slack.com/t/restatecommunity/shared_invite/zt-2v9gl005c-WBpr167o5XJZI1l7HWKImA", icon: "/img/slack.svg"}
        ]
    },
]}>
</ExampleWidget>

<Admonition type="note" title={"Didn't see your use case?"}>
    ðŸ’¡ You can invoke any handler asynchronously, so have a look at the other use case pages for more inspiration.
</Admonition>

## Developer Resources

<FeatureWidget features={[
    {
        title: 'Docs',
        description: (
            <p>
            <ul className={"text--left"}>
                <li><a href="/invoke/clients">Client library</a></li>
                <li><a href="/invoke/http">HTTP</a></li>
            </ul>
            </p>
        ),
    },
    {
        title: 'Docs: schedulers & timers',
        ts: "/develop/ts/durable-timers",
        java: "/develop/java/durable-timers?sdk=java",
        kotlin: "/develop/java/durable-timers?sdk=kotlin",
        go: "/develop/go/durable-timers",
        python: "/develop/python/durable-timers"
    },
    {
        title: 'Need help?',
        description: "Join the Restate Discord or Slack communities",
        links: [
            {url: "https://discord.gg/skW3AZ6uGd", icon: "/img/discord-icon.svg"},
            {url: "https://join.slack.com/t/restatecommunity/shared_invite/zt-2v9gl005c-WBpr167o5XJZI1l7HWKImA", icon: "/img/slack.svg"}
        ]
    }
]}/>