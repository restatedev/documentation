---
title: "Microservice Orchestration"
sidebar_position: 2
description: "Write resilient microservices with Restate"
hide_table_of_contents: true
hide_title: true
---

import FeatureWidget from "../../src/components/FeatureWidget"
import FeatureSpotlight from "../../src/components/FeatureSpotlight"
import ExampleWidget from "../../src/components/ExampleWidget"
import FeatureList from "../../src/components/FeatureList"
import SpotlightCard from "../../src/components/SpotlightCard"
import {Scrollycoding} from "../../src/components/code/scrollycoding";

<div className={"row"}>
    <div className={"col col--6 col-lg-6 col-md-12"}>
        <h1 className={"padding-top--lg text--left"}>Microservice Orchestration</h1>
        <h1 className={"use-case-subtitle text--left"}>The simplest way to build resilient applications.</h1>
        <p className={"use-case-description padding-bottom--lg text--left"}>
            Restate serves as the resilience and durability layer for distributed apps.
            Write regular functions and services, and let Restate make them resilient, consistent, and scalable.
        </p>
    </div>
    <div className={"col col--6 col-lg-6 col-md-12"}>
        <img src={"/img/use_cases/use-case-microservice-light.svg"} alt={"Microservice Orchestration"} className={"use-case-img"}/>
    </div>
</div>

<hr/>
<p className={"padding-bottom--lg"}></p>

<FeatureList className={"padding-bottom--lg"} features={[
    {
        title: 'Resiliency baked into familiar programming constructs',
        iconPath: '/img/code-icon.svg',
        description: "The Restate SDKs give you programming constructs that have retries and recovery baked in. Restate ensures code runs to the end: failures are retried and previous progress gets recovered.",
    },
    {
        title: 'Consistent application state',
        iconPath: '/img/use_cases/data.svg',
        description: "Restate persists code execution, including updates to state. State becomes effortlessly consistent with execution progress. Restate enforces a single writer per key to avoid lost updates and other concurrency issues.",
    },
    {
        title: 'Resilient communication and scheduling',
        iconPath: '/img/use_cases/call.svg',
        description: "Restate makes all communication resilient: request-response calls, async messages, webhooks, and scheduled tasks. No need for message queues, retry logic, deduplication, schedulers etc.",
    },
]}/>

<p className={"padding-bottom--lg"}></p>

## Resilient Code Execution

<Scrollycoding className="workflows-scroller">

    ### !!steps Familiar programming constructs, but now resilient
    Restate turns the programming building blocks you already know, into resilient constructs.
    Work with objects, functions, and promises as if failures don’t happen.
    Restate can recover them anytime, anywhere.

    [Learn more](/concepts/durable_building_blocks)

    ```ts !!tabs TypeScript https://github.com/restatedev/examples/blob/main/typescript/basics/src/0_durable_execution.ts
    CODE_LOAD::ts/src/use_cases/microservices/subscription_service.ts?1
    ```

    ```java !!tabs Java https://github.com/restatedev/examples/blob/main/java/basics/src/main/java/durable_execution/SubscriptionService.java
    CODE_LOAD::java/src/main/java/usecases/microservices/SubscriptionService.java?1
    ```

    ```kotlin !!tabs Kotlin https://github.com/restatedev/examples/blob/main/kotlin/basics/src/main/kotlin/durable_execution/SubscriptionService.kt
    CODE_LOAD::kotlin/src/main/kotlin/usecases/microservices/service/SubscriptionService.kt?1
    ```

    ```go !!tabs Go
    CODE_LOAD::go/usecases/microservices/service/subscriptionservice.go?1
    ```

    ```py !!tabs Python
    CODE_LOAD::python/src/use_cases/microservices/subscription_service.py?1
    ```


    ### !!steps Persist progress

    Do calls to multiple systems and persist the results.
    On retries, the action does not get re-executed but the previous result will be recovered.
    Interact with multiple systems in a row and Restate makes sure that all interactions take place.

    [Learn more](/concepts/durable_execution)

    ```ts !!tabs TypeScript https://github.com/restatedev/examples/blob/main/typescript/basics/src/0_durable_execution.ts
    CODE_LOAD::ts/src/use_cases/microservices/subscription_service.ts?2
    ```

    ```java !!tabs Java https://github.com/restatedev/examples/blob/main/java/basics/src/main/java/durable_execution/SubscriptionService.java
    CODE_LOAD::java/src/main/java/usecases/microservices/SubscriptionService.java?2
    ```

    ```kotlin !!tabs Kotlin https://github.com/restatedev/examples/blob/main/kotlin/basics/src/main/kotlin/durable_execution/SubscriptionService.kt
    CODE_LOAD::kotlin/src/main/kotlin/usecases/microservices/service/SubscriptionService.kt?2
    ```

    ```go !!tabs Go
    CODE_LOAD::go/usecases/microservices/service/subscriptionservice.go?2
    ```

    ```py !!tabs Python
    CODE_LOAD::python/src/use_cases/microservices/subscription_service.py?2
    ```

</Scrollycoding>


## Durable Communication, Scheduling & Idempotency

Restate sits like a reverse-proxy or message broker in front of your services.
It persists and deduplicates all communication to and between your services.

<Scrollycoding>

    ### !!steps Resilient RPC and messaging

    Restate proxies RPC calls and ensures they are delivered and processed:
    - request-response
    - message (one-way)
    - scheduled tasks

    [Learn more](/concepts/invocations)

    ```ts !!tabs TypeScript https://github.com/restatedev/examples/blob/main/typescript/patterns-use-cases/src/durablerpc/express_app.ts
    CODE_LOAD::ts/src/use_cases/microservices/idempotency.ts?1
    ```

    ```java !!tabs Java https://github.com/restatedev/examples/blob/main/java/patterns-use-cases/src/main/java/my/example/durablerpc/MyClient.java
    CODE_LOAD::java/src/main/java/usecases/microservices/Idempotency.java?1
    ```

    ```kotlin !!tabs Kotlin
    CODE_LOAD::kotlin/src/main/kotlin/usecases/microservices/Idempotency.kt?1
    ```

    ```go !!tabs Go
    CODE_LOAD::go/usecases/microservices/call/client/client.go?1
    ```

    ```py !!tabs Python
    CODE_LOAD::python/src/use_cases/microservices/idempotency.py?1
    ```

    ### !!steps Idempotency for free

    Add an idempotency token to your request to let Restate deduplicate them for you.
    Each request runs to completion exactly once.

    [Learn more](/concepts/invocations#idempotent-invocations)
    
    ```ts !!tabs TypeScript https://github.com/restatedev/examples/blob/main/typescript/patterns-use-cases/src/durablerpc/express_app.ts
    CODE_LOAD::ts/src/use_cases/microservices/idempotency.ts?2
    ```

    ```java !!tabs Java https://github.com/restatedev/examples/blob/main/java/patterns-use-cases/src/main/java/my/example/durablerpc/MyClient.java
    CODE_LOAD::java/src/main/java/usecases/microservices/Idempotency.java?2
    ```

    ```kotlin !!tabs Kotlin
    CODE_LOAD::kotlin/src/main/kotlin/usecases/microservices/Idempotency.kt?2
    ```

    ```go !!tabs Go
    CODE_LOAD::go/usecases/microservices/call/client/client.go?2
    ```

    ```py !!tabs Python
    CODE_LOAD::python/src/use_cases/microservices/idempotency.py?2
    ```
</Scrollycoding>


<SpotlightCard>
    <FeatureSpotlight
        title={"Regular functions and services, in your existing infra"}
        description={<p>Your code runs just like before: as Java or NodeJS applications on FaaS, K8s, servers, containers. <br/>
            On-prem or in the cloud. Restate meets you where you are.</p>}
        imgPath={"/img/use_cases/microservice_orchestration-white.svg"}
    />
</SpotlightCard>

## Sagas and Distributed Transactions
Restate guarantees code runs to completion. This lets you implement resilient [sagas](https://www.baeldung.com/cs/saga-pattern-microservices) in a try-catch block.
Restate takes care of retries and recovery.

<Scrollycoding>
    ### !!steps Track compensations

    If code execution is durable, then sagas can be expressed purely in code.

    As the function executes, we track the undo operations in a list.

    ```ts !!tabs TypeScript
    CODE_LOAD::ts/src/use_cases/microservices/subscription_saga.ts?1
    ```

    ```java !!tabs Java
    CODE_LOAD::java/src/main/java/usecases/microservices/SubscriptionSaga.java?1
    ```

    ```kotlin !!tabs Kotlin
    CODE_LOAD::kotlin/src/main/kotlin/usecases/microservices/saga/SubscriptionSaga.kt?1
    ```

    ```go !!tabs Go
    CODE_LOAD::go/usecases/microservices/saga/subscriptionsaga.go?1
    ```

    ```py !!tabs Python
    CODE_LOAD::python/src/use_cases/microservices/subscription_saga.py?1
    ```

    ### !!steps Guaranteed roll back

    When an error occurs for which we do not want to retry or continue, we roll back the changes we already did.

    Restate makes sure all compensations run.

    [Learn more](/guides/sagas)

    ```ts !!tabs TypeScript
    CODE_LOAD::ts/src/use_cases/microservices/subscription_saga.ts?2
    ```

    ```java !!tabs Java
    CODE_LOAD::java/src/main/java/usecases/microservices/SubscriptionSaga.java?2
    ```

    ```kotlin !!tabs Kotlin
    CODE_LOAD::kotlin/src/main/kotlin/usecases/microservices/saga/SubscriptionSaga.kt?2
    ```

    ```go !!tabs Go
    CODE_LOAD::go/usecases/microservices/saga/subscriptionsaga.go?2
    ```

    ```py !!tabs Python
    CODE_LOAD::python/src/use_cases/microservices/subscription_saga.py?2
    ```


</Scrollycoding>


## Stateful Entities and State Machines
Restate lets you implement stateful services by storing state in Restate.

<Scrollycoding>
    ### !!steps Consistent state

    Implement state machines, where state transitions are always consistent with the code.


    ```ts !!tabs TypeScript
    CODE_LOAD::ts/src/use_cases/microservices/subscription_object.ts?1
    ```

    ```java !!tabs Java
    CODE_LOAD::java/src/main/java/usecases/microservices/SubscriptionObject.java?1
    ```

    ```kotlin !!tabs Kotlin
    CODE_LOAD::kotlin/src/main/kotlin/usecases/microservices/vo/SubscriptionObject.kt?1
    ```

    ```go !!tabs Go
    CODE_LOAD::go/usecases/microservices/vo/subscriptionobject.go?1
    ```

    ```py !!tabs Python
    CODE_LOAD::python/src/use_cases/microservices/subscription_object.py?1
    ```

    ### !!steps Scalability, concurrency, consistency

    Restate guards consistency by making sure at most one handler is writing to a single state value.

    Scale out without fearing issues such as multiple writers to state, lost updates, race conditions, inconsistencies, etc.

    [Learn more](/concepts/services#virtual-objects)

    ```ts !!tabs TypeScript
    CODE_LOAD::ts/src/use_cases/microservices/subscription_object.ts?2
    ```

    ```java !!tabs Java
    CODE_LOAD::java/src/main/java/usecases/microservices/SubscriptionObject.java?2
    ```

    ```kotlin !!tabs Kotlin
    CODE_LOAD::kotlin/src/main/kotlin/usecases/microservices/vo/SubscriptionObject.kt?2
    ```

    ```go !!tabs Go
    CODE_LOAD::go/usecases/microservices/vo/subscriptionobject.go?2
    ```

    ```py !!tabs Python
    CODE_LOAD::python/src/use_cases/microservices/subscription_object.py?2
    ```

    ### !!steps Stateful serverless

    You can run stateful services on serverless infrastructure.
    Restate attaches the state to the request.
    Your handlers work on local state.

    [Learn more](https://restate.dev/blog/we-replaced-400-lines-of-stepfunctions-asl-with-40-lines-of-typescript-by-making-lambdas-suspendable/ )


    ```ts !!tabs TypeScript
    CODE_LOAD::ts/src/use_cases/microservices/subscription_object.ts?3
    ```

    ```java !!tabs Java
    CODE_LOAD::java/src/main/java/usecases/microservices/SubscriptionObject.java?3
    ```

    ```kotlin !!tabs Kotlin
    CODE_LOAD::kotlin/src/main/kotlin/usecases/microservices/vo/SubscriptionObject.kt?3
    ```

    ```go !!tabs Go
    CODE_LOAD::go/usecases/microservices/vo/subscriptionobject.go?3
    ```

    ```py !!tabs Python
    CODE_LOAD::python/src/use_cases/microservices/subscription_object.py?3
    ```
</Scrollycoding>

<SpotlightCard>
    <FeatureSpotlight
        title={"Detailed Observability"}
        description={<p>Restate tracks communication and execution, giving it a unique position for observability.<br/>
            Understand what is happening in your distributed applications, by using the UI, the CLI, and the built-in tracing.</p>}
        imgPath={"/img/use_cases/microservice_observability.svg"}
        imgSize={"100%"}
        button1={"What can you do with UI?"}
        link1={"https://restate.dev/blog/announcing-restate-ui/"}
        button2={"What can you do with CLI?"}
        link2={"/operate/introspection/"}
    />
</SpotlightCard>


## What you can build with Microservice Orchestration and Restate

<ExampleWidget features={[
    {
        title: 'Idempotent async payments',
        description: "Issue an idempotent payment to Stripe and process the response. The payment provider either responds immediately or notifies us later via a webhook.",
        links: [
            {url: "https://github.com/restatedev/examples/tree/main/java/patterns-use-cases/README.md#payment-signals", icon: "/img/java.svg"},
            {url: "https://github.com/restatedev/examples/tree/main/typescript/patterns-use-cases/README.md#payment-signals", icon: "/img/typescript.svg"},
            {url: "https://github.com/restatedev/examples/tree/main/python/patterns-use-cases/README.md#payment-signals", icon: "/img/python.svg"}
        ]
    },
    {
        title: 'Sagas',
        description: "Keep multiple systems in sync. For example, reserve a flight, then a car, then handle the payment. If the payment fails, roll back the reservations.",
        links: [{url: "/guides/sagas", icon: "/img/arrow-right.svg"}]
    },
    {
        title: 'Human-in-the-loop workflows',
        description: "Food ordering: handle payment, wait till desired delivery time, ask restaurant to start preparation, wait for restaurant to confirm, deliver.",
        links: [
            {url: "https://github.com/restatedev/examples/tree/main/java/end-to-end-applications/food-ordering", icon: "/img/java.svg"},
            {url: "https://github.com/restatedev/examples/tree/main/kotlin/end-to-end-applications/food-ordering", icon: "/img/kotlin.svg"},
            {url: "https://github.com/restatedev/examples/tree/main/typescript/end-to-end-applications/food-ordering", icon: "/img/typescript.svg"}
        ]
    },
    {
        title: 'Durable state machines',
        description: "Define state transitions in your handlers and store the current state in Restate. Use single-writer per key and concurrency limits to simplify writing robust state machines.",
        links: [
            { url: "https://github.com/restatedev/examples/tree/main/typescript/patterns-use-cases/README.md#stateful-actors-and-state-machines", icon: "/img/typescript.svg"},
            { url: "https://github.com/restatedev/examples/tree/main/java/patterns-use-cases/README.md#stateful-actors-and-state-machines", icon: "/img/java.svg"},
            { url: "https://github.com/restatedev/examples/tree/main/python/patterns-use-cases/README.md#stateful-actors-and-state-machines", icon: "/img/python.svg"},
            { url: "https://github.com/restatedev/examples/tree/main/go/patterns-use-cases/README.md#stateful-actors-and-state-machines", icon: "/img/go.svg"},
        ]
    },
    {
        title: 'Database interaction',
        description: "Use Restate to improve common access problems, solve race conditions, or avoid inconsistencies in the presence of retries, concurrent requests or zombie processes.",
        links: [
            { url: "/guides/databases#how-to-interact-with-databases-from-restate", icon: "/img/arrow-right.svg"},
        ]
    },
    {
        title: 'Wondering about a specific use case?',
        description: "Let’s brainstorm together on Discord or Slack.",
        links: [
            {url: "https://discord.gg/skW3AZ6uGd", icon: "/img/discord-icon.svg"},
            {url: "https://join.slack.com/t/restatecommunity/shared_invite/zt-2v9gl005c-WBpr167o5XJZI1l7HWKImA", icon: "/img/slack.svg"}
        ]
    },
]}>
</ExampleWidget>

## Developer Resources

<FeatureWidget features={[
    {
        title: 'Blog post',
        description: <i>Why we built Restate</i>,
        link: {url: "https://restate.dev/blog/why-we-built-restate/"}
    },
    {
        title: 'Learn',
        description: (
            "Follow the Tour of Restate to learn more."
        ),
        link: {url: "/get_started/tour"}
    },
    {
        title: 'Need help?',
        description: "Join the Restate Discord or Slack communities",
        links: [
            {url: "https://discord.gg/skW3AZ6uGd", icon: "/img/discord-icon.svg"},
            {url: "https://join.slack.com/t/restatecommunity/shared_invite/zt-2v9gl005c-WBpr167o5XJZI1l7HWKImA", icon: "/img/slack.svg"}
        ]
    }
]}/>
