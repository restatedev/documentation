---
sidebar_position: 10
description: "Receive events from Kafka."
---
import Admonition from '@theme/Admonition';

import Step from "../../../src/components/Stepper";

# Kafka
You can invoke handlers via Kafka events, by doing the following:

<Step stepLabel="1" title="Develop an event handler">

You can invoke any handler via Kafka events.
The event payload will be (de)serialized as JSON.

- When invoking **Virtual Object** handlers via Kafka, the key of the Kafka record will be used to determine the Virtual Object key.
For each Virtual Object, the events are delivered in the order in which they arrived on the topic partition.
- When invoking **Service** handlers over Kafka, events are delivered in parallel without ordering guarantees.

<Admonition type="tip" title="Combining RPC and Kafka within a service/handler">
    Since you can invoke any handler via Kafka events, a single handler can be invoked both by RPC and via Kafka.
</Admonition>

</Step>

<Step stepLabel="2" title="Configure Restate to connect to a Kafka cluster">
Define the Kafka cluster that Restate needs to connect to in the [Restate configuration file](/operate/configuration#configuration-file):

```toml
[[ingress.kafka-clusters]]
name = "my-cluster"
brokers = ["PLAINTEXT://broker:9092"]
```

Check the [configuration documentation](/operate/configuration) for more details.
</Step>

<Step stepLabel="3" title="Subscribe the event handler to the Kafka topic">
Let Restate forward events from the Kafka topic to the event handler by creating a subscription using the [Admin API](/references/admin-api):

```bash
# withClass tooltip kafka-subscription
curl localhost:9070/subscriptions -H 'content-type: application/json' \
    -d '{
    # withClass tooltip kafka-subscription-source
           "source": "kafka://my-cluster/my-topic",
    # withClass tooltip kafka-subscription-sink
           "sink": "component://MyService/Handle",
           "options": {"auto.offset.reset": "earliest"}
        }'
```

Once you've created a subscription, Restate immediately starts consuming events from Kafka.
The handler will be invoked for each event received from Kafka.

The `options` field is optional and accepts any configuration parameter from [librdkafka configuration](https://github.com/confluentinc/librdkafka/blob/master/CONFIGURATION.md).

</Step>

## Managing subscriptions
- **List** the current subscriptions via:
    ```bash
    # withClass tooltip kafka-subscription-list
    curl localhost:9070/subscriptions
    ```
    The creation and listing of subscriptions returns an identifier.
- **Delete** a subscription with its identifier via:
    ```bash
    # withClass tooltip kafka-subscription-delete
    curl -X DELETE localhost:9070/subscriptions/018cd978aa9f77b5a80454bc060c2a77
    ```

    <Admonition type="note">
    When you delete a subscription, Restate stops the consumer group associated to it. Any messages that were already enqueued by Restate will still be processed.
    </Admonition>
