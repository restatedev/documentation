---
sidebar_position: 7
description: "Find out how Restate services can send requests to each other."
---

import Admonition from '@theme/Admonition';

# Workflows

Workflows are a sequence of steps that gets executed durably.
A workflow can be seen as a special type of Virtual Object with some special characteristics.

In summary:

- A `run` handler that executes exactly one time for each workflow instance (object / key).
This handler implements the workflow logic.
- Optionally, other handlers that can be called multiple times, and can interact with the workflow.
- Some extra SDK functionality to signal workflows via [Durable Promises](/develop/ts/workflows#signaling-workflows).

<Admonition type="note" title={"Workflow retention time"}>
    The retention time of a workflow execution is 24 hours after the finishing of the `run` handler.
    After this timeout any K/V state is cleared, the workflow's shared handlers cannot be called anymore, and the Durable Promises are discarded.
    The retention time can be configured via the [Admin API](/references/admin-api/#tag/service/operation/modify_service) per Workflow definition by setting `workflow_completion_retention`.
</Admonition>

Have a look at the code example to get a better understanding of how workflows are implemented:

<CH.Scrollycoding className={"spotlight-medium"}>

    ### The `run` handler

    Every workflow needs a `run` handler.
    This handler has access to the same SDK features as Service and Virtual Object handlers.
    For example, use `ctx.run` to log intermediate results in Restate and avoid re-execution on replay.

    ```ts signup.ts mark=8:20
    CODE_LOAD::ts/src/develop/workflows/signup.ts
    ```

    ---

    ### Querying workflows

    You can query workflows via the other shared handlers defined in the workflow definition.
    For example, here we retrieve the status of the workflow.

    This is similar to how you would use shared handlers in a Virtual Object.

    ```ts signup.ts mark=25,26
    ```

    ---

    ### Signaling workflows

    You can use signals to interact with your running workflows.
    You can use them to let the workflow block until an event occurs, or to send a signal / information to a running workflow.

    You can implement signals via the Durable Promises feature of the SDK.
    These promises are durable and distributed, meaning they survive crashes and can be resolved or rejected by any handler in the workflow.

    Do the following:
    1. Create a promise in your `run` handler that is durable and distributed
    2. Resolve or reject the promise in any other handler in the workflow. This can be done at most one time.

    ```ts signup.ts mark=16,22,23
    ```

</CH.Scrollycoding>

## Submitting workflows

You can submit workflows in multiple ways:

<CH.Spotlight className={"spotlight-medium"}>
    **HTTP request-response** ([docs](/invoke/http#invoke-workflows)) <br/>
    Add `/send` to the path for one-way calls.

    ```shell
    curl localhost:8080/signup/someone/run \
        -H 'content-type: application/json' \
        -d '{"email": "someone@restate.dev"}'
    ```
</CH.Spotlight>
<CH.Spotlight className={"spotlight-medium"}>

    **Programmatically from a Restate service** ([docs](/develop/ts/service-communication)) <br/>
    Use the `workflowSendClient` to submit the workflow without waiting for the result.

    ```ts
    CODE_LOAD::ts/src/develop/workflows/service.ts
    ```
</CH.Spotlight>
<CH.Spotlight className={"spotlight-medium"}>
    **With the SDK clients** ([docs](/invoke/clients?sdk=ts))

    ```ts
    CODE_LOAD::ts/src/develop/workflows/submit.ts
    ```
</CH.Spotlight>

## Retrieving the result of workflows

You can attach to ongoing workflows and retrieve their result later.
You can either attach to a workflow and wait for it to finish, or you can peek at the output of the workflow.

<CH.Spotlight className={"spotlight-medium"}>

    **Via HTTP** ([docs](/invoke/http#retrieve-result-of-invocations-and-workflows))

    ```shell
    curl localhost:8080/restate/workflow/signup/someone/attach
    curl localhost:8080/restate/workflow/signup/someone/output
    ```

</CH.Spotlight>

<CH.Spotlight className={"spotlight-medium"}>

    **Via SDK clients** ([docs](/invoke/clients?sdk=ts#retrieve-result-of-invocations-and-workflows))

    ```ts
    CODE_LOAD::ts/src/develop/workflows/interact.ts
    ```
</CH.Spotlight>

Look at the [HTTP](/invoke/http#retrieve-result-of-invocations-and-workflows) or [client invocation docs](/invoke/clients?sdk=ts#retrieve-result-of-invocations-and-workflows) for more details.

<Admonition type={"info"} title={"Inspecting workflows"}>
    Have a look at the [CLI docs](/operate/introspection) on how to inspect workflows.
</Admonition>






